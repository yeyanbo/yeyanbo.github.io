---
layout: post
title: 编写 XSLT 时使用的一些技巧
tags: [xslt]
---

##简介##

![用例及交互图](/resources/xslfo_pages_01.gif)

###准备###

在进行后续技术说明的前面，我们先编写一个作为文件源的XML文件：

``` xml
<book>
	<title>This is a Book</title>
	<section id="section_1">
		<para>这是第一章内容</para>
	</section>
	<section id="section_2">
		<para>这是第二章内容</para>
	</section>
	<section id="section_3">
		<para>这是第三章内容</para>
	</section>
</book>
```

##基本XSLT编写套路##

先提一个最简单的目的，我们想把这个XML转换成为一个HTML页面，用于浏览。

``` xml
<xsl:stylesheet version="1.1" ...>
	<xsl:output method="html" version="1.0" indent="yes" encoding="utf-8"/>
	
	<xsl:template match="book">
		<html>
			<head>
				<title><xsl:value-of select="title"/></title>
			</head>
			<body>
				<xsl:apply-templates select="section"/>
			</body>
		</html>
		<h1></h1>
	</xsl:template>
	
	<xsl:template match="section">
		<h1><xsl:value-of select="@id"/></h1>
		<xsl:apply-templates select="para"/>
	</xsl:template>
	
	<xsl:template match="para">
		<pre><xsl:value-of select="."/><pre>
	</xsl:template>
```

转换后的HTML页是什么样子呢？

``` html
<html>
	<head>
		<title></title>
	</head>
	<body>
		<h1>section_1</h1>
		<pre>这是第一章内容</pre>
		<h1>section_2</h1>
		<pre>这是第二章内容</pre>
		<h1>section_3</h1>
		<pre>这是第三章内容</pre>
	</body>
</html>
``` 

##如何将多个文件合并为一个文件##


##如何为一个XML节点指定多个处理模板##

``` xml
	<xsl:template match="validationOverview" mode="toc">
		<fo:bookmark internal-destination="overview">
      		<fo:bookmark-title>Validation Overview</fo:bookmark-title>
    	</fo:bookmark>
	</xsl:template>
	<xsl:template match="validationOverview">
		<fo:block id="overview" font-family="Simsun" font-size="12pt" space-after.optimum="6pt" margin-left="6pt">
			注意: 这里填写校验概要信息！ 
        </fo:block>
	</xsl:template>
```


获取兄弟节点
----

可以获取当前节点以前的兄弟节点中最靠近该节点的一个，示例是个很完整的表示，包括命名空间和指定特定节点情况：

``` xml
    <xsl:template match="svrl:successful-report">
        <p>
        	<xsl:value-of select="@test"/>
        	<xsl:value-of select="(preceding-sibling::svrl:active-pattern)[last()]/@id"/>
        </p>
    </xsl:template>
```

可以从中衍生很多取值方式。

为一个元素的属性赋值
----

不应直接在属性值的引号内直接使用``<xsl:value-of select="id"/>``。而应该使用``<xsl:attribute>``为Element节点添加属性。

``` xml
<xsl:template match="ruleResult">
  <fo:block font-family="Simsun" font-size="12pt">
  	<xsl:attribute name="id">
  		<xsl:value-of select="id" />
  	</xsl:attribute>
  </fo:block>
</xsl:template>
```

输出结果为：

```xml
<fo:block font-family="Simsun" font-size="12pt" id="abc">
</fo:block>
```

``<block>``元素多了一个``@id``属性。

如何在使用Java语言来处理XSLT转换
----

